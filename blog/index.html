<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
      <meta content="width=device-width, initial-scale=1" name="viewport" />
    <title></title>
    <link rel="stylesheet" href="/assets/css/blog-styles.css">
    <link href="https://fonts.googleapis.com/css?family=Cabin:600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800&display=swap" rel="stylesheet">
  </head>
  </head>
  <body>
    <div id='title-nav'>
      <h1>Coding Journal</h1>
      <nav>
  
  
    <a href="/" >
      Home
    </a>
    
  
    <a href="/blog" >
      Blog
    </a>
    
  
    <a href="https://www.linkedin.com/in/jordan-b-vidrine/" >
      LinkedIn
    </a>
    
</nav>

      <div id='bio'>
              <img src="https://media.licdn.com/dms/image/C5603AQGuQnyqi_WYSQ/profile-displayphoto-shrink_200_200/0?e=1565827200&v=beta&t=LY5mk_3gumx40ZQP2FBSoKf_8xTb4SKGF7P0KFJkIW4">
        <h3>Jordan Vidrine</h3>
        <p>
          An experienced business owner + musician with a demonstrated history of management in the
          Energy sector and an insatiable appetite for learning new and complex skills. Transitioning
          from an ownership role & seeking employment in Web Development as a Jr Full Stack Developer.
        </p>
      </div>
    </div>
    <div id="posts">
  <ul>
    
    <li>
<<<<<<< HEAD
=======
      <h2>August 13th 2019</h2>
      <p><p>Wow. What a week! Since last Tuesday up until this morning my time has been spent setting up, rehearsing, performing, and  setting down from my Art Spark performance. It was the best musical performance and activity I have ever had the privilege to participate in! If you’d like to check out some of that info, feel free to browse through my <a href="http://www.facebook.com/skiesspeakband">artist facebook page</a></p>

<p>Now that I’m finished with the performance aspect of the grant, I will be able to devote more time to learning to code. So, lets move on!</p>

<h3 id="uploading-files-with-multer-npm-package">Uploading files with multer npm package</h3>
<p>The first part of my learning today was back to the uploading files section of the node course. We are doing this by using the multer npm package. I started off today with a challenge to:</p>
<ol>
  <li>Limit the upload size to 1MB</li>
  <li>Only allow jpg, jpeg, or png files</li>
</ol>

</p>
      
      <a id='read-more' href="/2019/08/August-13th-2019.html#posts">Read More...</a>
      
    </li>
    
    <li>
>>>>>>> e6e73ea8e0c28e3e194830e94f64e2df704cd413
      <h2>August 5th 2019</h2>
      <p><p>Today I’ll be getting back to the NodeJS course I am working through on Udemy. I feel like I have learned a really good amount of great information from this course. I’ve been able to personally use every piece of knowledge from this course into various personal apps and experiments since I started the course.</p>

<h3 id="sorting-pagination--filtering-in-mongoosemongodb">Sorting, Pagination, &amp; Filtering in Mongoose/MongoDB</h3>
<p>The first thing we implemented today was the ability for the database to use timestamps. This was super simple and only involved adding an options object as an argument when creating the Schema for a model.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">timestamps</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div>
<p>What this does is add a <code class="highlighter-rouge">createdAt</code> and <code class="highlighter-rouge">updatedAt</code> field to each item created in the database.</p>

</p>
      
      <a id='read-more' href="/2019/08/August-5th-2019.html#posts">Read More...</a>
      
    </li>
    
    <li>
      <h2>July 30th & 31st 2019</h2>
      <p><p>Since I was so interested in making my idea work, I spent this week diving into finishing my simple Budgeting/Text Messaging app instead of my regular developer course work I normally do. For today’s post I will give you an overview of the project and what I did to accomplish the goals I had when I set out.</p>

<h2 id="project-goals">Project Goals</h2>
<p>Even with the YNAB app being well designed and easy to use, entering small and basic transactions can be done in an easier way in my opinion. I set out to save time by not having to log into the YNAB app, navigate to the appropriate budget account, and input the transaction. The two main things I wanted to be able to do were:<br /><br />
<strong>1. Get the amount left in a budget category by sms text</strong><br /><br />
<strong>2. Enter transactions by sms text</strong><br />
<br /></p>
<h3 id="getting-started">Getting Started</h3>
<p>After researching a bit I decided to use the Twilio service to serve as the SMS interaction between the express routes I would create to interact with the YNAB data. I went through <a href="https://www.twilio.com/docs/sms/quickstart/node#install-nodejs-and-the-twilio-module">the basic walkthrough on their site</a> to get familiar with the service, but decided I would build the app and test it via Postman before incorporating the Twilio service.</p>

<p>One big reason for this is that Twilio gives you a free trial credit of $15.00 that slowly gets used up when sending and receiving messages. I knew I’d be sending ALOT of back and forth during the testing so I didnt want to dwindle this balance.</p>

<h3 id="setting-up-the-express-app">Setting up the Express App</h3>
<p>This for me is getting to the point where it is very straightforward and the syntax is finally starting to look normal and make sense.</p>

<p>The gist of what’s happening here is that I am telling express to use the bodyParser (needed for the Twilio Integration), <code class="highlighter-rouge">express.json()</code> method, and lastly (at the bottom of the code, but before the <code class="highlighter-rouge">app.listen()</code> call) to use my custom error handler. I also tell express to use my <code class="highlighter-rouge">smsParse</code> middleware when recieving POST requests. The last line tells the express app to be listening on port 1337 of my computer, aka ‘localhost’.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">express</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">MessagingResponse</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">twilio</span><span class="dl">'</span><span class="p">).</span><span class="nx">twiml</span><span class="p">.</span><span class="nx">MessagingResponse</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">bodyParser</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">body-parser</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">request</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">smsParse</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">./middleware/smsParse</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="nx">handleError</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">./middleware/handleError</span><span class="dl">'</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span><span class="na">extended</span><span class="p">:</span><span class="kc">false</span><span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">,</span> <span class="nx">smsParse</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// Boiler plate formatting to send a text message.</span>
  <span class="c1">// res.message has the message saved to it from the smsParse middleware</span>
  <span class="c1">// we will be sending that to the user who sent an SMS to the number</span>
  <span class="c1">// Twilio has provided us</span>
  <span class="kd">let</span> <span class="nx">twiml</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MessagingResponse</span><span class="p">();</span>
  <span class="nx">twiml</span><span class="p">.</span><span class="nx">message</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,{</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">text/xml</span><span class="dl">'</span><span class="p">});</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="nx">twiml</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span>
<span class="p">})</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">handleError</span><span class="p">)</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="mi">1337</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Express server listening on port 1337</span><span class="dl">'</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="middleware">Middleware</h3>
<p>The following are the syntax examples of how a user can interact with the app. The first part is what is sent by the user to the number Twilio provides and the second part is the response that would be received.</p>

<p><strong>To get budget data</strong><br />
Groceries // You have $50.41 left in your Dining Out budget.<br />
<strong>Enter a Purchase</strong><br />
Groceries -12.34 Wal-Mart // Your transaction with Wal Mart in the amount of $-12.34 was successfully entered.<br />
<strong>Enter a Refund</strong><br />
// Enter Credit: Groceries 10.00 Wal-Mart » Your transaction with Wal Mart in the amount of $10.00 was successfully entered.<br /></p>

<p>I setup this middleware to be able to parse the body of the request and determine if the user wants to inset a transaction, or get their budget amount.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">getCategory</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">../helpers/getCategory</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">ynabActions</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">../helpers/ynabActions</span><span class="dl">'</span><span class="p">)</span>

<span class="nx">smsParse</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="nx">res</span><span class="p">,</span><span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">numOfArgs</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>

  <span class="c1">// checks if arguments exist</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">numOfArgs</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">category</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">);</span>

    <span class="c1">// Only passing in one argument retrieves the balance of that argument/category</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">numOfArgs</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ynabActions</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">(</span><span class="nx">category</span><span class="p">);</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="s2">`You have </span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">balance</span><span class="p">}</span><span class="s2"> left in your </span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">budget</span><span class="p">}</span><span class="s2"> budget.`</span>
        <span class="nx">next</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">next</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
      <span class="p">}</span>

    <span class="c1">// To Cred or Deb an acct, 3 arguments must be passed</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">numOfArgs</span> <span class="o">===</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">[...</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">)]</span>
      <span class="kd">let</span> <span class="nx">cat</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">);</span>

      <span class="c1">// converting amt to miliunits (number passed MUST in have two decimal places &gt;&gt; 2.33, -23.45)</span>
      <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="dl">'</span><span class="s1">.</span><span class="dl">'</span><span class="p">,</span><span class="dl">''</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span>
      <span class="kd">let</span> <span class="nx">amt</span> <span class="o">=</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
      <span class="kd">let</span> <span class="nx">payee</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">replace</span><span class="p">(</span><span class="dl">'</span><span class="s1">-</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="p">);</span>

      <span class="c1">// checks the argument types, must be correct to continue on</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">cat</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">amt</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">number</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">payee</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
          <span class="kd">let</span> <span class="nx">transactionData</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ynabActions</span><span class="p">.</span><span class="nx">addTransaction</span><span class="p">(</span><span class="nx">category</span><span class="p">,</span><span class="nx">amt</span><span class="p">,</span><span class="nx">payee</span><span class="p">)</span>
          <span class="c1">// saves the response to res.message to be passed back to the user</span>
          <span class="nx">res</span><span class="p">.</span><span class="nx">message</span> <span class="o">=</span> <span class="nx">transactionData</span><span class="p">.</span><span class="nx">successMsg</span><span class="p">;</span>

          <span class="nx">next</span><span class="p">()</span>
        <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">next</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// Syntax Error Message</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nx">send</span><span class="p">({</span><span class="na">Error</span><span class="p">:</span><span class="dl">'</span><span class="s1">Syntax Error!</span><span class="se">\n</span><span class="s1">For Balance Inquiry &gt;&gt; Category </span><span class="se">\n</span><span class="s1"> For Purchase &gt;&gt; Category, -Purchase Amt, Payee</span><span class="se">\n</span><span class="s1"> For Refund &gt;&gt; Category, Refund Amt, Payee</span><span class="dl">'</span> <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">smsParse</span>
</code></pre></div></div>
<h3 id="ynab-helper-functions">YNAB Helper Functions</h3>
<p>I consolidated the YNAB interaction functions to an object with methods inside of it. All of the YNAB interaction happens inside the following script. They interact with that API through the <a href="https://www.npmjs.com/package/ynab">YNAB npm package</a>, rather than making http requests on my own. It is also at this time that I learned about the <a href="https://www.npmjs.com/package/dotenv">dotenv NPM package</a>. This is used to store secret keys, passwords, and auth tokens for use in the node.js code. Thanks to Dan at the <a href="https://www.acadianasoftwaregroup.org/">Acadiana Software Group’s</a> slack page for that!</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">dotenv</span><span class="dl">'</span><span class="p">).</span><span class="nx">config</span><span class="p">()</span>
<span class="kd">const</span> <span class="nx">ynab</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ynab</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">ynabAPI</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ynab</span><span class="p">.</span><span class="nx">API</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">YNAB_ACCESS_TOKEN</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">getCategory</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">./getCategory</span><span class="dl">'</span><span class="p">)</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="k">async</span> <span class="nx">getBalance</span><span class="p">(</span><span class="nx">category</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">categoryData</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">getCategoryData</span><span class="p">(</span><span class="nx">category</span><span class="p">)</span>
      <span class="kd">let</span> <span class="nx">balance</span> <span class="o">=</span> <span class="s2">`$`</span> <span class="o">+</span> <span class="nx">ynab</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">convertMilliUnitsToCurrencyAmount</span><span class="p">(</span><span class="nx">categoryData</span><span class="p">.</span><span class="nx">balance</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
      <span class="c1">// add trailing 0 to any number with one decimal place</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">balance</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="dl">'</span><span class="s1">.</span><span class="dl">'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">balance</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="s1">.</span><span class="dl">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">].</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span> <span class="nx">balance</span> <span class="o">=</span> <span class="nx">balance</span><span class="o">+</span><span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="p">;</span> <span class="p">}</span>
      <span class="kd">let</span> <span class="nx">budget</span> <span class="o">=</span> <span class="nx">categoryData</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
      <span class="k">return</span> <span class="p">{</span> <span class="nx">balance</span> <span class="p">,</span> <span class="nx">budget</span> <span class="p">}</span>
    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="k">async</span> <span class="nx">addTransaction</span><span class="p">(</span><span class="nx">category</span><span class="p">,</span><span class="nx">amt</span><span class="p">,</span><span class="nx">payee</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">categoryData</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">getCategoryData</span><span class="p">(</span><span class="nx">category</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">categoryData</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Category not found!</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">}</span>
      <span class="c1">// Search to see if payee already exists in the payee database</span>
      <span class="kd">let</span> <span class="nx">payeesData</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">getPayee</span><span class="p">(</span><span class="nx">payee</span><span class="p">)</span>
      <span class="kd">let</span> <span class="nx">payee_name</span><span class="p">;</span>
      <span class="c1">// If payee does exist, set payee_name to match name in database so a new payee is not created</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">payeesData</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">payee_name</span> <span class="o">=</span> <span class="nx">payeesData</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
      <span class="c1">// if payee does not exist in database, set the payee name to the one entered</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">payeesData</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">payee_name</span> <span class="o">=</span> <span class="nx">payee</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="c1">// define transaction object to pass to the ynab api</span>
      <span class="kd">let</span> <span class="nx">transaction</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">account_id</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">FAKE_BANK_ID</span><span class="p">,</span>
        <span class="na">amount</span><span class="p">:</span> <span class="nx">amt</span><span class="p">,</span>
        <span class="na">date</span><span class="p">:</span> <span class="nx">ynab</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getCurrentDateInISOFormat</span><span class="p">(),</span>
        <span class="na">payee_id</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="na">payee_name</span><span class="p">:</span> <span class="nx">payee_name</span><span class="p">,</span>
        <span class="na">category_id</span><span class="p">:</span> <span class="nx">categoryData</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span>
        <span class="na">cleared</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="na">approved</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="na">memo</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
      <span class="p">};</span>

      <span class="kd">let</span> <span class="nx">transactionData</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ynabAPI</span><span class="p">.</span><span class="nx">transactions</span><span class="p">.</span><span class="nx">createTransaction</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">TEST_BUDGET_ID</span><span class="p">,</span> <span class="p">{</span><span class="nx">transaction</span><span class="p">});</span>

      <span class="k">return</span> <span class="p">{</span><span class="nx">transactionData</span><span class="p">,</span> <span class="na">successMsg</span><span class="p">:</span> <span class="s2">`Your transaction with </span><span class="p">${</span><span class="nx">transactionData</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">payee_name</span><span class="p">}</span><span class="s2"> in the amount of </span><span class="p">${</span><span class="s2">`$`</span> <span class="o">+</span> <span class="nx">ynab</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">convertMilliUnitsToCurrencyAmount</span><span class="p">(</span><span class="nx">transactionData</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">transaction</span><span class="p">.</span><span class="nx">amount</span><span class="p">,</span><span class="mi">2</span><span class="p">)}</span><span class="s2"> was successfully entered in the </span><span class="p">${</span><span class="nx">categoryData</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2"> category.`</span><span class="p">};</span>

    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// create custom error based on the returned error from the YNAB api</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">e</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2">: </span><span class="p">${</span><span class="nx">e</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">detail</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
      <span class="p">}</span>
      <span class="k">throw</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="k">async</span> <span class="nx">getCategoryData</span><span class="p">(</span><span class="nx">category</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">categoriesData</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ynabAPI</span><span class="p">.</span><span class="nx">categories</span><span class="p">.</span><span class="nx">getCategories</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">TEST_BUDGET_ID</span><span class="p">);</span>
      <span class="c1">// I perform this filter because the API returns an internal master list that doesnt seem necessary to my app</span>
      <span class="kd">let</span> <span class="nx">filteredData</span> <span class="o">=</span> <span class="nx">categoriesData</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">category_groups</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">cat</span> <span class="o">=&gt;</span> <span class="nx">cat</span><span class="p">[</span><span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">]</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">Internal Master Category</span><span class="dl">"</span><span class="p">);</span>
      <span class="kd">let</span> <span class="nx">categoryData</span> <span class="o">=</span> <span class="nx">getCategory</span><span class="p">(</span><span class="nx">filteredData</span><span class="p">,</span> <span class="nx">category</span><span class="p">)</span>
      <span class="k">return</span> <span class="nx">categoryData</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="k">async</span> <span class="nx">getPayee</span><span class="p">(</span><span class="nx">payee</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">payees</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ynabAPI</span><span class="p">.</span><span class="nx">payees</span><span class="p">.</span><span class="nx">getPayees</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">TEST_BUDGET_ID</span><span class="p">);</span>
      <span class="kd">let</span> <span class="nx">foundPayee</span> <span class="o">=</span> <span class="nx">payees</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">payees</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">item</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="k">return</span> <span class="nx">item</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">===</span> <span class="nx">payee</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()})</span>
      <span class="k">return</span> <span class="nx">foundPayee</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<h3 id="recursing-through-the-data">Recursing through the data</h3>
<p>One issue I had to tackle was the ability to find the correct Category’s ID, based on what the user inputs into the text. YNAB returns an entire list of categories when you request a budget using the budget ID, but in order to get the specific amount left in a category, you need the category ID and have to make a separate request.</p>

<p>To find the ID, I created a recursive function that would search through category data, and their sub categories until it found the matching category that the user needed. The function returns the category object, which includes data like the amount left in the budget, and other important data points one may be interested in.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">getCategory</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">categoryToMatch</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">category</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>

    <span class="kd">function</span> <span class="nx">recurse</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="nx">categoryToMatch</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">===</span> <span class="nx">categoryToMatch</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span> <span class="p">{</span>
                  <span class="nx">category</span> <span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                  <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">categories</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
                  <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">categories</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                     <span class="nx">recurse</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">categories</span><span class="p">,</span> <span class="nx">categoryToMatch</span><span class="p">)</span>
                     <span class="k">if</span> <span class="p">(</span><span class="nx">category</span><span class="p">)</span> <span class="p">{</span>
                         <span class="k">break</span><span class="p">;</span>
                     <span class="p">}</span>
                  <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">recurse</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span><span class="nx">categoryToMatch</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">category</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">getCategory</span>
</code></pre></div></div>
<h3 id="custom-error-handling">Custom Error Handling</h3>
<p>Express handles errors automatically pretty well. After encountering small issues with returning the correct error at certain points in the code, I decided to make my own simple error handler.</p>

<p>To do this, you just need to call <code class="highlighter-rouge">app.use(YourErrorHandler)</code> at the bottom of the express script. In your error handler you need to pass in <code class="highlighter-rouge">err</code> as the first argument, which will be the errors that express has encountered. Here is that code:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">handleError</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">req</span><span class="p">,</span><span class="nx">res</span><span class="p">,</span><span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span><span class="na">error</span><span class="p">:</span><span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span> <span class="na">type</span><span class="p">:</span> <span class="nx">err</span><span class="p">.</span><span class="nx">name</span><span class="p">})</span>
<span class="p">}</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">handleError</span><span class="p">;</span>
</code></pre></div></div>
<h3 id="working-example">Working Example</h3>
<p><img src="https://media.giphy.com/media/dC8gilXeMVDTrAgx8O/giphy.gif" alt="example-app" /></p>
<h3 id="final-thoughts">Final Thoughts</h3>
<p>I really REALLY enjoyed creating and working on this app. The challenge of not working with a browser AT ALL was unique and exciting for me. It helped me to realize how much of our interactions with data and the web are for the most part behind the scenes. It sort of solidified my interest in back-end development over front-end as well. I am interested in hashing this idea out even further to add a bit more complexity to the user interactions, while still keeping it simple enough to not have to go into the YNAB app for every interaction with your budget.</p>
</p>
      
    </li>
    
    <li>
      <h2>July 26th & 29th 2019</h2>
      <p><p>Last Friday (26th) and today (29th) I spent some time diving into the API of my favorite budgeting app. (<a href="http://www.ynab.com">YNAB!</a>)</p>

<p>I had a random idea Friday morning to explore the ability to create an app that can receive an SMS text message like “Grocery Budget Left” and then return something like “You have $63.00 left in your groceries budget.”</p>

<p>I searched and figured out I would need to use TWILIO or something similar. I ended up creating an account and going through their intro docs and was able to create a very simple example in a couple of hours. What I turned out was just hard coded budget amount that I got the ID for by reading through the YNAB docs. I sent a text to the TWILIO # and got back the amount of my grocery budget.</p>

</p>
      
      <a id='read-more' href="/2019/07/July-26th-&-29th-2019.html#posts">Read More...</a>
      
    </li>
    
    <li>
      <h2>July 24th 2019</h2>
      <p><p>Today I will be going back to the NodeJS course as I feel like I have been able to implement everything I’ve learned thus far on my own with the Drawing App.</p>

<h4 id="logging-out">Logging Out</h4>
<p>Below we setup a route to log a user out. This simply authenticates the user using an auth middleware we wrote previously. Once the user is authenticated, it checks the users list of active tokens and removes the one currently saved to the req method, which was saved there during their authentication.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/users/logout</span><span class="dl">'</span><span class="p">,</span> <span class="nx">auth</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">tokens</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">tokens</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">token</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">token</span><span class="p">.</span><span class="nx">token</span> <span class="o">!==</span> <span class="nx">req</span><span class="p">.</span><span class="nx">token</span>
    <span class="p">})</span>

    <span class="k">await</span> <span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">save</span><span class="p">()</span>

    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">()</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nx">send</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>
<p>To ‘Log Out from All Locations’ we simply remove ALL of the tokens from the token array stored in the User object, rather than the only ‘active’ one. We can do this by setting the user’s tokens to an empty array like so. <code class="highlighter-rouge">req.user.tokens = []</code></p>

</p>
      
      <a id='read-more' href="/2019/07/July-24th-2019.html#posts">Read More...</a>
      
    </li>
    
    <li>
      <h2>July 23rd 2019</h2>
      <p><p>Today I pushed my app in development to Heroku for testing and to show a couple of friends. It is now live at <a href="http://jbv-drawing-prompt-app.herokuapp.com">jbv-drawing-prompt-app.herokuapp.com</a></p>

<p>During the process I encountered a couple of CORS issues as well as some database connection issues. It made me glad that I added a console log to the mongodb connection JS file that either alerts ‘Connected To Dabase’ or ‘Could not connect to database’</p>

<p>I got everything to work by doing the following:</p>

</p>
      
      <a id='read-more' href="/2019/07/July-23rd-2019.html#posts">Read More...</a>
      
    </li>
    
    <li>
      <h2>July 22nd 2019</h2>
      <p><p>Got back from vacation last night FULLY relaxed and ready to get back into the daily grind. While on the trip I put in an hour or two here and there working through codewars.com exercises and puzzles. Fun stuff.</p>

<p>This morning I started the day off with rehashing what I learned on my last coding day. I also implemented a couple of new features into the site I am working on.</p>

<p>I added an admin panel that shows me what ‘items’ users have submitted. It then shows me if they are approved or unapproved, as well as gives me the ability to delete any item. This is VERY similar to MANY todolist tutorials and I can see why those tutorials are so important. Basically everything on the web is a TODO list type item.</p>

</p>
      
      <a id='read-more' href="/2019/07/July-22nd-2019.html#posts">Read More...</a>
      
    </li>
    
    <li>
      <h2>July 14th & 15th 2019</h2>
      <p><p>I spent yesterday and this morning getting deeper with working with MongoDB. I really enjoy using mongoose.js to interface with the mongo database as well. I spent time implementing my own CRUD operations, sending get and post requests to my own express app on the backend.</p>

<p>This morning, after realizing that git version control wasnt working with my database folder for the app I am working on, I migrated my database over to MongoDB Atlas. This is a cloud database that offers a couple free tier options. I like the UI for the site as well as the ability to access the database from any computer I will be working from.</p>

<p>The implementation was extremely simple as well.</p>

<p>I am now going to go through a couple more videos from the NodeJS course. At this time I am 61% complete and I feel like I have learned a pretty large amount of tools.</p>

</p>
      
      <a id='read-more' href="/2019/07/July-14th-&-15th-2019.html#posts">Read More...</a>
      
    </li>
    
    <li>
      <h2>July 13th 2019</h2>
      <p><p>So Hurricane Barry is making its way to land. Im posted up at my parents house in case the power back home goes out. I’ve been reading a bit of SICP which apparently is a computer programmer’s/CS Major’s dream book. I’ve also been going through MIT lectures on the book and I find it very interesting.</p>

<p>The language it will be focused on is a dialect of Lisp called Scheme. This all comes recommended to my by a friend who’s has his degree in CS. I think it’s a good reccomendation as the book is going through the basic building blocks of what programs are, of what interpreters are, and what is actually going on behind the scenes when we write programs. I love this type of stuff, taking it all apart is so interesting to me.</p>

<p>Anyway! That being said, I felt it necessary to also go back to the Regex section of Eloquent Javascript. Why? Because in it is a section on writing a parsing function that interprets an INI file using regex statements. Here is the example the book gives.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">parseINI</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Start with an object to hold the top-level fields</span>
  <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="kd">let</span> <span class="nx">section</span> <span class="o">=</span> <span class="nx">result</span><span class="p">;</span>
  <span class="nx">string</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/</span><span class="se">\r?\n</span><span class="sr">/</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">line</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">match</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">match</span> <span class="o">=</span> <span class="nx">line</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^</span><span class="se">(\w</span><span class="sr">+</span><span class="se">)</span><span class="sr">=</span><span class="se">(</span><span class="sr">.*</span><span class="se">)</span><span class="sr">$/</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">section</span><span class="p">[</span><span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">match</span> <span class="o">=</span> <span class="nx">line</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^</span><span class="se">\[(</span><span class="sr">.*</span><span class="se">)\]</span><span class="sr">$/</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">section</span> <span class="o">=</span> <span class="nx">result</span><span class="p">[</span><span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="sr">/^</span><span class="se">\s</span><span class="sr">*</span><span class="se">(</span><span class="sr">;.*</span><span class="se">)?</span><span class="sr">$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">line</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Line '</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">line</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">' is not valid.</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

</p>
      
      <a id='read-more' href="/2019/07/July-13th-2019.html#posts">Read More...</a>
      
    </li>
    
    <li>
      <h2>July 10th 2019</h2>
      <p><p>Since it’s been a couple of days since I last worked through more of the NodeJS course. I’m starting the morning off by reviewing the last hour or so of videos. Running through bcrypt password hashing usage, mongoose model middelware to run before saving anything to the database, and json web tokens.</p>

<h4 id="json-web-tokens-jwt">Json Web Tokens (jwt)</h4>
<p>Every express route we define will fall into either a ‘public’ or ‘private’ category. It will either be accessible to anyone, or sit behind authentication, and users would have to be authed to use it.</p>

<p>Our signup and login route will be the only public routes available to the user. We dont want users deleting OTHER users tasks or updating things of the sort. To do this, we will implement authentication with Json web tokens.</p>

<p>We will be using the <a href="https://www.npmjs.com/package/jsonwebtoken">jsonwebtoken</a> npm library to do all of this. Heres what a super simple implemenation could look like.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">jwt</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">jsonwebtoken</span><span class="dl">'</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">myFunction</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">({</span><span class="na">_id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">abcd1234</span><span class="dl">'</span><span class="p">},</span> <span class="dl">'</span><span class="s1">secretsignature</span><span class="dl">'</span><span class="p">)</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">token</span><span class="p">)</span>
  <span class="c1">// eyJhbGciOiJIUzI1NiIsInR5cCI6Ik.... more really long token data</span>
  <span class="c1">// the token comes back as 3 chunks of data separated by periods.</span>
  <span class="c1">// the first piece is a base64 json string header with meta info</span>
  <span class="c1">// the second piece is the payload/body containing the data provided {_id: 'abcd1234'}</span>
  <span class="c1">// the third piece is the signature</span>

</code></pre></div></div>
<p>The goal of a json web token isnt to hide the data we provide. The whole point is to create data that is verifiable via the signature.</p>

<p>Whats going on behind the scenes is this. Lets copy the middle part of the token provided to us and ‘decode’ it at <a href="https://www.base64decode.org/">base64decode.org</a> - we get this back: <code class="highlighter-rouge">{"_id":"abcd1234","iat":1562776753}</code> The “iat” is the timestamp at which the jwt was created.</p>

<h4 id="verifying-the-tokens">Verifying the tokens</h4>

<p>We can use the <code class="highlighter-rouge">.verify()</code> that the package gives us to verify a token:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// .verify() takes the token to verify, and the secret string used to create that token as arguments</span>
<span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="dl">'</span><span class="s1">mysecretstring</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>

<span class="c1">// {"_id":"abcd1234","iat":1562776753}</span>
</code></pre></div></div>
<p>We can also set expiration by providing a third argument to the <code class="highlighter-rouge">.sign()</code> method like so:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">({</span><span class="na">_id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">abcd1234</span><span class="dl">'</span><span class="p">},</span> <span class="dl">'</span><span class="s1">secretsignature</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="na">expiresIn</span><span class="p">:</span> <span class="dl">'</span><span class="s1">1h</span><span class="dl">'</span><span class="p">})</span>
</code></pre></div></div>

<p>This would set the token to expire in one hour, effectively logging the user out after one hour.</p>

<h4 id="logging-inspect">Logging inspect</h4>
<p>We will now use jwt to create a token to send to the user when signing up, or when logging into the site. Each request will send the user jwt tokens. We will write a re-usable function that different handlers can use whenever we need to generate a token.</p>

<p>We will store this on <code class="highlighter-rouge">userSchema.methods</code> as opposed to <code class="highlighter-rouge">userSchema.statics</code>  which will give each user instance the function we can use. Static methods are accessible on the Model as a whole, but regular methods are accessible on instances of that model.</p>

<p>Lets first create that method.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">userSchema</span><span class="p">.</span><span class="nx">methods</span><span class="p">.</span><span class="nx">generateAuthToken</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="c1">// jwt expects a string in the payload object you pass to it, so we use .toString() to do that.</span>
  <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">({</span><span class="na">_id</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">_id</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="p">},</span><span class="dl">'</span><span class="s1">thisismysecretsentence</span><span class="dl">'</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">token</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>Next, lets change the users/login route to call this function and add that to what we send to the user.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/users/login</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">findByCredentials</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">password</span><span class="p">)</span>
    <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">user</span><span class="p">.</span><span class="nx">generateAuthToken</span><span class="p">()</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span> <span class="nx">user</span><span class="p">,</span> <span class="nx">token</span><span class="p">})</span>
  <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">400</span><span class="p">).</span><span class="nx">send</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Great! It worked. Now when we send a request to /users/login with the correct body info filled out we get this back. (I am using postman for all of my http requests)</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="err">//</span><span class="w"> </span><span class="err">...data</span><span class="w"> </span><span class="err">here</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"token"</span><span class="p">:</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">data</span><span class="w"> </span><span class="err">here</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>At this point we provide the auth token to the client for them to use on any request that requires it. We are not keeping track of this currently on the server. The server generates it and then sends it back. Right now users cant truly log out while the token exists. We can fix this by tracking tokens we generate for users. It will allow them to log in on multiple devices, with each token tracked to that login/logout.</p>

<p>We will store all of the auth tokens created for a user in the user document. To do this, we only have to add a little code to the User Schema, as well as the .generateAuthToken method we just created.</p>

<p>To the Schema we add:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// this allow us to create an array of objects on the user. Each object will contain a token that will be a string.</span>
<span class="nx">tokens</span><span class="p">:</span> <span class="p">[{</span>
  <span class="na">token</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="na">required</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">}</span>
<span class="p">}]</span>
</code></pre></div></div>
<p>To the .generateAuthToken method we add the following before the return call:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">user</span><span class="p">.</span><span class="nx">tokens</span> <span class="o">=</span> <span class="nx">user</span><span class="p">.</span><span class="nx">tokens</span><span class="p">.</span><span class="nx">concat</span><span class="p">({</span> <span class="nx">token</span> <span class="p">});</span>
<span class="k">await</span> <span class="nx">user</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
</code></pre></div></div>
<p>This will concatenate the current token inside of an object to the current array of objects with tokens. Now our returned json.body looks like this when posting to users/login</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">_id</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">5d1d0f94316a5340744f4d9a</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Jordan</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">email</span><span class="dl">"</span><span class="p">:</span> <span class="c1">// email data</span>
        <span class="dl">"</span><span class="s2">password</span><span class="dl">"</span><span class="p">:</span> <span class="c1">// password data</span>
        <span class="dl">"</span><span class="s2">__v</span><span class="dl">"</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">tokens</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="dl">"</span><span class="s2">_id</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">5d261de27254e010f8799f8e</span><span class="dl">"</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">token</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZDFkMGY5NDMxNmE1MzQwNzQ0ZjRkOWEiLCJpYXQiOjE1NjI3NzkxMDZ9.WDxucPGY_7HVyl8fLgmvAC2MUIW9qxkPTPsGwLRtAQM</span><span class="dl">"</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="dl">"</span><span class="s2">token</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZDFkMGY5NDMxNmE1MzQwNzQ0ZjRkOWEiLCJpYXQiOjE1NjI3NzkxNzR9.mEkkXpWvND1V0lfsm2TuKoBP5YxArNqA4OlwSKKqGOE</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div>
<p>Now we will move onto authenticating users and having them be able to only do certain things depending on their auth. We will do this with express middleware on certain routes. Here is a simple example of something we can use middleware to do (we put this above our routes in our index.js file):</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">((</span><span class="nx">req</span><span class="p">,</span><span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="dl">'</span><span class="s1">GET requests are currently under construction!</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">next</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>
<p>The code above will intercept all http requests and first check if it is a GET method. If so, it will send to the user that GET requests are currently being worked on. All other methods will be run as normal, moving onto the next function by calling <code class="highlighter-rouge">next()</code>.</p>

<p>This type of functionality will be how we use authentication. When creating middleware to use on our site it is normal to store your middleware functions in a folder src/middleware. We will create a file there called auth.js and load it into our routers.</p>

<p>We will use middleware for only certain routes. To add middleware to only certain routes, you pass the function to use as middleware as your second argument. In between the route, and the callback that route will run. DONT FORGET TO CALL NEXT() in the middleware function.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">router</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/users</span><span class="dl">'</span><span class="p">,</span> <span class="nx">middelwareFunc</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// code here...</span>
<span class="p">})</span>
</code></pre></div></div>

<p>The user will be able to be authenticated by sending the latest auth key they recieved to the server via GET method and headers. For learning purposes we will setup for a user to send a GET request to users/me and be returned their on info. We will accomplish this by adding an Authorization header with ‘Bearer **token’ -  We will do this like so:</p>
<h5 id="authjs">auth.js</h5>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">jwt</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">jsonwebtoken</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">User</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">../models/user</span><span class="dl">'</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">auth</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="nx">res</span><span class="p">,</span><span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">header</span><span class="p">(</span><span class="dl">'</span><span class="s1">Authorization</span><span class="dl">'</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="dl">'</span><span class="s1">Bearer </span><span class="dl">'</span><span class="p">,</span><span class="dl">''</span><span class="p">)</span>

    <span class="c1">// if verified decoded should look lik {_id: ....., iat: .....}</span>
    <span class="kd">const</span> <span class="nx">decoded</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="dl">'</span><span class="s1">thisismysecretsentence</span><span class="dl">'</span><span class="p">)</span>

    <span class="c1">// this will look for a user with the ID that also has the token in their array of tokens</span>
    <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="na">_id</span><span class="p">:</span> <span class="nx">decoded</span><span class="p">.</span><span class="nx">_id</span><span class="p">,</span> <span class="dl">'</span><span class="s1">tokens.token</span><span class="dl">'</span><span class="p">:</span> <span class="nx">token</span> <span class="p">})</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="c1">// store the returned user to the req object so the next part of the express functions will not have to look it up again</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">user</span>
    <span class="nx">next</span><span class="p">()</span>

  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">401</span><span class="p">).</span><span class="nx">send</span><span class="p">({</span><span class="na">error</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Please Authenticate.</span><span class="dl">'</span><span class="p">})</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">auth</span>
</code></pre></div></div>
<h5 id="in-the-user-routes">in the user routes</h5>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// get user profile</span>
<span class="nx">router</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/users/me</span><span class="dl">'</span><span class="p">,</span> <span class="nx">auth</span> <span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">user</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>
<p>Adding this returns the users data to them, if they are currently logged in. We do this by checking if the key the browsers sends to the server is still in the tokens array and active.</p>

<h3 id="next-tasks">Next Tasks</h3>
<p>After spending the morning working through all of this I then created my own versisons of what we did in the tutorials. I created a login page and saved users to a mongodb database using postman, sending user info in the body of my requests to create multiple users.</p>

<p>I then created a ‘log in’ page and added the functionality for a user to submit their username and password. This sends a fetch request to a custom route I setup using express and returns the user’s data and a new token to them if the user name and password were correct.</p>

<p>Here is some of that code from the front end.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">userName</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">username</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">var</span> <span class="nx">submit</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">submit</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="nx">errorText</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="kd">var</span> <span class="nx">token</span><span class="p">;</span>

<span class="nx">submit</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">http://localhost:3000/login/user</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="dl">'</span><span class="s1">Accept</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span>
    <span class="p">},</span>
    <span class="na">body</span><span class="p">:</span>
      <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
        <span class="na">userName</span><span class="p">:</span> <span class="nx">userName</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
        <span class="na">password</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">password</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span>
      <span class="p">})</span>
  <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">errorText</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
        <span class="nx">errorText</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="dl">'</span><span class="s1">error-animate</span><span class="dl">'</span><span class="p">)</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
        <span class="kd">let</span> <span class="p">{</span><span class="na">_id</span><span class="p">:</span><span class="nx">id</span><span class="p">,</span> <span class="na">userName</span><span class="p">:</span><span class="nx">user</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">user</span>
        <span class="nx">token</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">token</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">user</span><span class="p">)</span>
        <span class="c1">//userName.value = ''</span>
        <span class="c1">//document.getElementById('password').value = ''</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Unable to log in</span><span class="dl">'</span><span class="p">)</span>
        <span class="nx">errorText</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Unable to log in.</span><span class="dl">'</span><span class="p">;</span>
        <span class="nx">errorText</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="dl">'</span><span class="s1">error-animate</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">})</span>
<span class="p">})</span>
</code></pre></div></div>
</p>
      
    </li>
    
<<<<<<< HEAD
    <li>
      <h2>July 9th 2019</h2>
      <p><p>Working from a great coffee shop in Lafayette today. Starting off the day reading through the asynchronous programming chapter in Eloquent Javascript. I feel fairly confident in what async functions are and how they work, but I want to read through this chapter to solidify any loose thinking in regards to that.</p>

<h3 id="chapter-11-async---eloquent-javascript">Chapter 11 Async - Eloquent Javascript</h3>
<p>The author has a sense of humor. We will be learning the ins and outs of async by writing networking functions for a fictitious crow colony that has learned how to use javascript and communicate from nest to nest by sending signals to and from each other…. interesting.</p>

<h4 id="callbacks">Callbacks</h4>
<p>One approach to async programming is to make functions that perform a slow action take a callback argument to run when the code is finished working. (We learned about this in the NodeJS course we are currently working through.) As we learned previously, this can get convoluted quickly when wanting to perform more than one async operation. The example below has two callbacks. Any more and this could lead to hard to lots of nesting and hard to read code. IE.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">bigOak</span><span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./crow-tech</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">bigOak</span><span class="p">.</span><span class="nx">readStorage</span><span class="p">(</span><span class="dl">"</span><span class="s2">food caches</span><span class="dl">"</span><span class="p">,</span> <span class="nx">caches</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="c1">// first callback</span>
  <span class="kd">let</span> <span class="nx">firstCache</span> <span class="o">=</span> <span class="nx">caches</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
  <span class="nx">bigOak</span><span class="p">.</span><span class="nx">readStorage</span><span class="p">(</span><span class="nx">firstCache</span><span class="p">,</span> <span class="nx">info</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="c1">// second nested callback</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">info</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>

</p>
      
      <a id='read-more' href="/2019/07/July-9th-2019.html#posts">Read More...</a>
      
    </li>
    
=======
>>>>>>> e6e73ea8e0c28e3e194830e94f64e2df704cd413
  </ul>
  
  <div id='pagination'>
  
  
    <a id ='older' href="/blog/page/2/">Older Posts ></a>
  
  </div>
  
  <footer>
<p>Created with Jekyll by Jordan Vidrine - <a href="https://www.linkedin.com/in/jordan-b-vidrine/">LinkedIn</a> - <a href="https://github.com/jordanvidrine">GitHub</a></p>
</footer>
</section>

</div>

  </body>
</html>
